# ================================
# 鉴宝后端服务环境配置模板
# 复制此文件为 .env 并填入实际值
# ================================

# ================================
# 应用基础配置
# ================================
ENVIRONMENT=production
APP_NAME=jianbao-backend
APP_VERSION=1.0.0
DEBUG=false
LOG_LEVEL=INFO

# ================================
# 服务器配置
# ================================
HOST=0.0.0.0
PORT=8000
WORKERS=4
RELOAD=false

# ================================
# 数据库配置
# ================================
# MySQL主数据库
DATABASE_URL=mysql+pymysql://jianbao:password@mysql.jianbao.com:3306/jianbao_db?charset=utf8mb4
DATABASE_HOST=mysql.jianbao.com
DATABASE_PORT=3306
DATABASE_NAME=jianbao_db
DATABASE_USER=jianbao
DATABASE_PASSWORD=your_mysql_password_here

# 数据库连接池配置
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# ================================
# Redis缓存配置
# ================================
REDIS_URL=redis://:password@redis.jianbao.com:6379/0
REDIS_HOST=redis.jianbao.com
REDIS_PORT=6379
REDIS_PASSWORD=your_redis_password_here
REDIS_DB=0
REDIS_MAX_CONNECTIONS=10

# ================================
# JWT认证配置
# ================================
JWT_SECRET_KEY=your_jwt_secret_key_at_least_32_characters_long_here
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=1440
JWT_REFRESH_TOKEN_EXPIRE_MINUTES=10080

# ================================
# 腾讯云COS配置
# ================================
COS_SECRET_ID=your_cos_secret_id_here
COS_SECRET_KEY=your_cos_secret_key_here
COS_BUCKET=jianbao-files
COS_REGION=ap-beijing
COS_DOMAIN=https://files.jianbao.com
COS_CDN_DOMAIN=https://cdn.jianbao.com

# ================================
# 微信小程序配置
# ================================
WECHAT_APP_ID=your_wechat_mini_program_app_id
WECHAT_APP_SECRET=your_wechat_mini_program_app_secret
WECHAT_API_URL=https://api.weixin.qq.com

# ================================
# 文件处理配置
# ================================
MAX_FILE_SIZE=52428800  # 50MB
ALLOWED_IMAGE_EXTENSIONS=jpg,jpeg,png,gif,webp
ALLOWED_VIDEO_EXTENSIONS=mp4,avi,mov,mkv
IMAGE_QUALITY=85
THUMBNAIL_SIZE=200
UPLOAD_TEMP_DIR=/tmp/uploads

# ================================
# Celery异步任务配置
# ================================
CELERY_BROKER_URL=redis://:password@redis.jianbao.com:6379/1
CELERY_RESULT_BACKEND=redis://:password@redis.jianbao.com:6379/2
CELERY_TIMEZONE=Asia/Shanghai
CELERY_WORKER_CONCURRENCY=4
CELERY_TASK_SOFT_TIME_LIMIT=300
CELERY_TASK_TIME_LIMIT=600

# ================================
# 容器镜像仓库配置
# ================================
TCR_REGISTRY=ccr.ccs.tencentyun.com
TCR_NAMESPACE=jianbao
TCR_USERNAME=your_tcr_username
TCR_PASSWORD=your_tcr_password

# ================================
# Kubernetes配置
# ================================
NAMESPACE=jianbao-system
TKE_CLUSTER_ID=cls-xxxxxxxxx
TKE_REGION=ap-beijing

# ================================
# 计费模式配置（按量付费）
# ================================
BILLING_MODE=POSTPAID_BY_HOUR
TKE_BILLING_MODE=POSTPAID_BY_HOUR
CVM_BILLING_MODE=POSTPAID_BY_HOUR
MYSQL_BILLING_MODE=POSTPAID_BY_HOUR
REDIS_BILLING_MODE=POSTPAID_BY_HOUR
COS_BILLING_MODE=POSTPAID_BY_HOUR

# ================================
# 域名配置
# ================================
API_DOMAIN=api.jianbao.com
API_BASE_URL=https://api.jianbao.com
ALLOWED_HOSTS=api.jianbao.com,localhost,127.0.0.1

# ================================
# CORS配置
# ================================
CORS_ALLOW_ORIGINS=https://admin.jianbao.com,https://*.jianbao.com,http://localhost:3000
CORS_ALLOW_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOW_HEADERS=*
CORS_ALLOW_CREDENTIALS=true

# ================================
# 监控配置
# ================================
METRICS_ENABLED=true
METRICS_PATH=/metrics
HEALTH_CHECK_PATH=/health
READINESS_CHECK_PATH=/health/ready

# ================================
# 日志配置
# ================================
LOG_FORMAT=json
LOG_FILE=/app/logs/app.log
LOG_ROTATION=midnight
LOG_RETENTION=7

# ================================
# 安全配置
# ================================
SECRET_KEY=your_application_secret_key_here
SECURITY_PASSWORD_SALT=your_password_salt_here
ENCRYPTION_KEY=your_encryption_key_32_chars_long

# ================================
# 限流配置
# ================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_DEFAULT=100/minute
RATE_LIMIT_UPLOAD=10/minute
RATE_LIMIT_AUTH=5/minute

# ================================
# 邮件配置（可选）
# ================================
SMTP_HOST=smtp.qq.com
SMTP_PORT=587
SMTP_USERNAME=your_email@qq.com
SMTP_PASSWORD=your_email_password
SMTP_TLS=true
MAIL_FROM=noreply@jianbao.com

# ================================
# 通知配置
# ================================
WECHAT_WEBHOOK_URL=https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=your_webhook_key
DINGTALK_WEBHOOK_URL=https://oapi.dingtalk.com/robot/send?access_token=your_token

# ================================
# 开发环境配置
# ================================
# 仅在开发环境使用
DEV_DATABASE_URL=mysql+pymysql://root:password@localhost:3306/jianbao_dev
DEV_REDIS_URL=redis://localhost:6379/0
DEV_COS_BUCKET=jianbao-files-dev